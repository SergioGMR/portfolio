---
import PageShell from '@/components/layout/PageShell.astro'
import LangText from '@/components/LangText.astro'
import { EXPERIENCE, LINKS, STACK } from '@/lib/constants'
import { Image } from 'astro:assets'
import heroImg from '../../public/me_laptop.webp'
import todoLuxImg from '../../public/experience/todo-lux.webp'
import basuralezaImg from '../../public/experience/basuraleza.webp'
import solutecImg from '../../public/experience/solutec.webp'
import tcatikImg from '../../public/experience/tcatik.webp'
const experiencesEs = EXPERIENCE.es.slice(0, 3)
const experiencesEn = EXPERIENCE.en.slice(0, 3)

const experienceImages: Record<string, any> = {
  'https://projects.todo-lux.com/': todoLuxImg,
  'https://proyectolibera.org/caracterizacion-residuos/basuraleza':
    basuralezaImg,
  'https://solutec.pccom.ai/': solutecImg,
  'https://tcatik.com/': tcatikImg,
}

const experienceCards = experiencesEs.map((exp, idx) => ({
  es: exp,
  en: experiencesEn[idx],
  image: experienceImages[exp.link] || todoLuxImg,
}))
---

<PageShell
  title='Sergio Morales Rodríguez — Full Stack Developer'
  description='Full Stack portfolio of Sergio Morales Rodríguez. Backend-focused (PHP/Laravel) con TypeScript/React para entregar producto.'
  schema={{
    '@context': 'https://schema.org',
    '@type': 'Person',
    name: 'Sergio Morales Rodríguez',
    jobTitle: 'Full Stack Developer',
    sameAs: [LINKS.github, LINKS.linkedin, LINKS.twitter],
  }}
>
  <section class='grid gap-8 lg:grid-cols-[1.3fr_1fr] lg:items-center'>
    <div class='space-y-6'>
      <p class='text-sm uppercase tracking-[0.25em] text-muted-foreground'>
        <LangText es='Desarrollador Full Stack' en='Full Stack Developer' />
      </p>
      <h1 class='text-4xl font-semibold leading-[1.1] sm:text-5xl'>
        <LangText
          es='Diseño, construyo y optimizo productos digitales.'
          en='I design, build, and optimize digital products.'
        />
      </h1>
      <p class='max-w-2xl text-lg text-muted-foreground'>
        <LangText
          es='Backend first con PHP/Laravel, APIs y un toque de front con TypeScript/React. Orientado a entregar rápido y con calidad.'
          en='Backend-first with PHP/Laravel, APIs, and a front touch with TypeScript/React. Focused on shipping fast with quality.'
        />
      </p>
      <div class='flex flex-wrap items-center gap-3'>
        <a
          href='mailto:sergiogmr+portfolio@icloud.com'
          class='rounded-full bg-foreground px-5 py-2 text-sm font-semibold text-background transition hover:opacity-90'
        >
          <LangText es='Hablemos' en="Let's talk" />
        </a>
        <a
          data-lang-content='es'
          href='/sergio-morales-2024-es.pdf'
          class='rounded-full border px-5 py-2 text-sm font-semibold transition hover:bg-foreground hover:text-background'
          target='_blank'
        >
          Ver CV
        </a>
        <a
          data-lang-content='en'
          href='/sergio-morales-2024-en.pdf'
          class='rounded-full border px-5 py-2 text-sm font-semibold transition hover:bg-foreground hover:text-background'
          target='_blank'
        >
          View CV
        </a>
      </div>
      <div class='flex flex-wrap gap-2 text-xs uppercase tracking-[0.2em] text-muted-foreground'>
        {
          ['PHP', 'Laravel', 'TypeScript', 'React', 'Tailwind'].map(item => (
            <span class='rounded-full border px-3 py-1'>{item}</span>
          ))
        }
      </div>
    </div>
    <div class='relative flex justify-center'>
      <div class='absolute -left-6 -top-6 h-20 w-20 rounded-full bg-primary/40 blur-3xl'></div>
      <div class='absolute right-4 top-10 h-16 w-16 rounded-full bg-purple-500/30 blur-3xl'></div>
      <div class='relative h-full w-full max-w-md overflow-hidden rounded-3xl border bg-gradient-to-br from-slate-900 to-slate-700 p-[1px] shadow-xl dark:from-slate-100 dark:to-white'>
        <Image
          src={heroImg}
          alt='Sergio working on laptop'
          class='h-full w-full object-cover'
          loading='eager'
          fetchpriority='high'
          decoding='async'
          width={900}
          height={900}
          sizes='(min-width: 1024px) 50vw, 100vw'
        />
      </div>
    </div>
  </section>

  <section class='grid gap-10 rounded-3xl border bg-muted/40 p-8 sm:p-10'>
    <div class='flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between'>
      <div>
        <p class='text-xs uppercase tracking-[0.3em] text-muted-foreground'>
          <LangText es='Trayectoria' en='Background' />
        </p>
        <h2 class='text-2xl font-semibold sm:text-3xl'>
          <LangText es='Experiencia seleccionada' en='Selected experience' />
        </h2>
      </div>
      <a
        href='https://www.linkedin.com/in/sergiogmr'
        class='text-sm font-semibold underline-offset-4 hover:underline'
      >
        LinkedIn
      </a>
    </div>
    <div class='grid gap-6 md:grid-cols-2'>
      {
        EXPERIENCE.es.slice(0, 4).map((exp, idx) => (
          <article data-lang-content='es' class='rounded-2xl border bg-background/70 p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-lg'>
            <div class='flex items-center justify-between'>
              <p class='text-xs uppercase tracking-[0.2em] text-muted-foreground'>{exp.start} — {exp.end}</p>
              <span class='rounded-full bg-primary/10 px-3 py-1 text-[11px] font-semibold text-primary'>
                {idx === 0 ? 'Actual' : 'Freelance'}
              </span>
            </div>
            <h3 class='mt-3 text-xl font-semibold'>{exp.position}</h3>
            <a class='text-sm text-primary underline-offset-4 hover:underline' href={exp.link}>{exp.company}</a>
            <ul class='mt-4 flex list-disc flex-col gap-2 pl-4 text-sm text-muted-foreground'>
              {exp.tasks.slice(0, 3).map(item => <li>{item}</li>)}
            </ul>
          </article>
        ))
      }
      {
        EXPERIENCE.en.slice(0, 4).map((exp, idx) => (
          <article data-lang-content='en' class='rounded-2xl border bg-background/70 p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-lg'>
            <div class='flex items-center justify-between'>
              <p class='text-xs uppercase tracking-[0.2em] text-muted-foreground'>{exp.start} — {exp.end}</p>
              <span class='rounded-full bg-primary/10 px-3 py-1 text-[11px] font-semibold text-primary'>
                {idx === 0 ? 'Current' : 'Freelance'}
              </span>
            </div>
            <h3 class='mt-3 text-xl font-semibold'>{exp.position}</h3>
            <a class='text-sm text-primary underline-offset-4 hover:underline' href={exp.link}>{exp.company}</a>
            <ul class='mt-4 flex list-disc flex-col gap-2 pl-4 text-sm text-muted-foreground'>
              {exp.tasks.slice(0, 3).map(item => <li>{item}</li>)}
            </ul>
          </article>
        ))
      }
    </div>
  </section>

  <section class='grid gap-6 rounded-3xl border bg-background/80 p-8 sm:p-10 lg:grid-cols-[1.1fr_1fr]'>
    <div class='space-y-4'>
      <p class='text-xs uppercase tracking-[0.3em] text-muted-foreground'>
        <LangText es='Skills' en='Skills' />
      </p>
      <h2 class='text-2xl font-semibold sm:text-3xl'>
        <LangText es='Stack y enfoque' en='Stack and focus' />
      </h2>
      <p class='text-muted-foreground'>
        <LangText
          es='Foco en backend escalable y APIs limpias. Priorizo flujos claros de entrega y comunicación con negocio.'
          en='Focus on scalable backend and clean APIs. I prioritize clear delivery flows and business alignment.'
        />
      </p>
      <div class='flex flex-wrap gap-2'>
        {STACK.map(item => (
          <span class='rounded-full border px-3 py-1 text-sm'>{item}</span>
        ))}
      </div>
    </div>
    <div class='grid grid-cols-1 gap-4 sm:grid-cols-2'>
      <div class='rounded-2xl border bg-muted/50 p-5'>
        <p class='text-xs uppercase tracking-[0.3em] text-muted-foreground'>
          <LangText es='Backend' en='Backend' />
        </p>
        <p class='mt-2 text-lg font-semibold'>PHP · Laravel · APIs</p>
        <p class='text-sm text-muted-foreground'>
          <LangText es='Arquitectura hexagonal, colas, eventos, auth.' en='Hexagonal architecture, queues, events, auth.' />
        </p>
      </div>
      <div class='rounded-2xl border bg-muted/50 p-5'>
        <p class='text-xs uppercase tracking-[0.3em] text-muted-foreground'>Frontend</p>
        <p class='mt-2 text-lg font-semibold'>TypeScript · React</p>
        <p class='text-sm text-muted-foreground'>
          <LangText es='UI accesible con Tailwind, componentes a medida.' en='Accessible UI with Tailwind, custom components.' />
        </p>
      </div>
      <div class='rounded-2xl border bg-muted/50 p-5'>
        <p class='text-xs uppercase tracking-[0.3em] text-muted-foreground'>
          <LangText es='Comunicación' en='Communication' />
        </p>
        <p class='mt-2 text-lg font-semibold'>
          <LangText es='Negocio & producto' en='Business & product' />
        </p>
        <p class='text-sm text-muted-foreground'>
          <LangText es='Traducción de requisitos a entregables medibles.' en='Translate requirements into measurable deliverables.' />
        </p>
      </div>
    </div>
  </section>

  <section class='grid gap-6 rounded-3xl border bg-muted/30 p-8 sm:p-10'>
    <div class='flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between'>
      <div>
        <p class='text-xs uppercase tracking-[0.3em] text-muted-foreground'>
          <LangText es='Proyectos' en='Projects' />
        </p>
        <h2 class='text-2xl font-semibold sm:text-3xl'>
          <LangText es='Trabajo reciente' en='Recent work' />
        </h2>
      </div>
    </div>
    <div class='grid gap-4 md:grid-cols-3'>
      {
        experienceCards.map((card, idx) => (
          <a
            href={card.es.link}
            target='_blank'
            rel='noreferrer noopener'
            class='group block rounded-2xl border bg-background/80 p-4 shadow-sm transition hover:-translate-y-1 hover:shadow-lg'
          >
            <div class='relative mb-4 overflow-hidden rounded-xl border bg-muted'>
              <Image
                src={card.image}
                alt={card.es.company}
                class='h-40 w-full object-cover transition duration-300 group-hover:scale-105'
                loading='lazy'
                decoding='async'
                width={900}
                height={560}
                sizes='(min-width: 768px) 33vw, 100vw'
              />
            </div>
            <div data-lang-content='es' class='space-y-2'>
              <div class='flex items-center justify-between'>
                <h3 class='text-lg font-semibold'>{card.es.company}</h3>
                <span class='text-sm text-primary'>→</span>
              </div>
              <p class='text-sm font-semibold text-foreground'>{card.es.position}</p>
              <p class='text-xs uppercase tracking-[0.18em] text-muted-foreground'>
                {card.es.start} — {card.es.end}
              </p>
              <p class='text-sm text-muted-foreground'>
                {card.es.tasks.slice(0, 2).join(' • ')}
              </p>
            </div>
            <div data-lang-content='en' class='space-y-2'>
              <div class='flex items-center justify-between'>
                <h3 class='text-lg font-semibold'>{card.en?.company}</h3>
                <span class='text-sm text-primary'>→</span>
              </div>
              <p class='text-sm font-semibold text-foreground'>{card.en?.position}</p>
              <p class='text-xs uppercase tracking-[0.18em] text-muted-foreground'>
                {card.en?.start} — {card.en?.end}
              </p>
              <p class='text-sm text-muted-foreground'>
                {card.en?.tasks?.slice(0, 2).join(' • ')}
              </p>
            </div>
            <div class='mt-4 flex flex-wrap gap-2 text-[11px] font-semibold uppercase tracking-[0.18em] text-muted-foreground'>
              <span class='rounded-full border px-2 py-1'>{idx === 0 ? 'Live' : 'Project'}</span>
            </div>
          </a>
        ))
      }
    </div>
  </section>

  <section class='grid gap-6 rounded-3xl border bg-background/90 p-8 sm:p-10 lg:grid-cols-[1.1fr_1fr]'>
    <div class='space-y-4'>
      <p class='text-xs uppercase tracking-[0.3em] text-muted-foreground'>
        <LangText es='Sobre mí' en='About' />
      </p>
      <h2 class='text-2xl font-semibold sm:text-3xl'>
        <LangText es='Colaboro de forma cercana y pragmática.' en='I collaborate closely and pragmatically.' />
      </h2>
      <p class='text-muted-foreground'>
        <LangText
          es='Me gusta entrar en proyectos con contexto, mapear riesgos, definir métricas y entregar rápido. Hablo con negocio y con ingeniería.'
          en='I like to enter projects with context, map risks, define metrics, and ship fast. I talk with business and engineering.'
        />
      </p>
      <div class='rounded-2xl border bg-muted/40 p-4 text-sm text-muted-foreground'>
        <LangText
          es='Ubicado en Islas Canarias (UTC+0/+1). Trabajo remoto y asincrónico con equipos distribuidos.'
          en='Based in Canary Islands (UTC+0/+1). Remote and async with distributed teams.'
        />
      </div>
    </div>
    <div class='rounded-3xl border bg-muted/40 p-6 shadow-inner'>
      <p class='text-xs uppercase tracking-[0.25em] text-muted-foreground'>
        <LangText es='Contacto' en='Contact' />
      </p>
      <div class='mt-4 space-y-3'>
        <div class='flex items-center justify-between rounded-2xl border bg-background/80 px-4 py-3'>
          <span class='text-sm text-muted-foreground'>
            <LangText es='Email' en='Email' />
          </span>
          <a class='font-semibold hover:underline' href='mailto:sergiogmr+portfolio@icloud.com'>sergiogmr@icloud.com</a>
        </div>
        <div class='flex items-center justify-between rounded-2xl border bg-background/80 px-4 py-3'>
          <span class='text-sm text-muted-foreground'>LinkedIn</span>
          <a class='font-semibold hover:underline' href='https://www.linkedin.com/in/sergiogmr' target='_blank'>@sergiogmr</a>
        </div>
        <div class='flex items-center justify-between rounded-2xl border bg-background/80 px-4 py-3'>
          <span class='text-sm text-muted-foreground'>GitHub</span>
          <a class='font-semibold hover:underline' href='https://github.com/sergiogmr' target='_blank'>@sergiogmr</a>
        </div>
      </div>
    </div>
  </section>
</PageShell>
